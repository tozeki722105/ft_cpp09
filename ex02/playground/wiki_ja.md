計算機科学において、マージ挿入ソート、またはフォード・ジョンソンアルゴリズムは、L.R.フォード・ジュニアとセルマー・M・ジョンソンによって1959年に発表された比較ソートアルゴリズムです。これは、それまで知られていた最良のアルゴリズムであるバイナリ挿入ソートやマージソートよりも、最悪の場合の比較回数が少なくなります。そして20年間、既知の比較回数が最も少ないソートアルゴリズムでした。実用的には重要ではありませんが、最小の比較回数でソートするという問題に関連して、理論的な興味を引いています。同じアルゴリズムは、スタニスワフ・トリーブラとチェン・ピンによって独自に発見された可能性もあります。

マージ挿入ソートは、n個の要素の入力Xに対して、以下の手順を実行します。

1. Xの要素を⌊n/2⌋組の要素に任意にグループ化し、要素数が奇数の場合、1つの要素をペアにしないで残します。
2. ⌊n/2⌋回の比較を実行し、ペアごとに1回の比較を行い、各ペアの2つの要素のうち大きい方を決定します。
3. マージ挿入ソートを使用して、各ペアから⌊n/2⌋個の大きい方の要素を再帰的にソートし、入力要素の⌊n/2⌋個のソート済みシーケンスSを昇順で作成します。
4. Sの先頭に、Sの最初で最小の要素とペアになった要素を挿入します。
5. X∖Sの残りの⌈n/2⌉-1個の要素を、以下で説明する特別に選択された挿入順序で、一度に1つずつSに挿入します。 Sのサブシーケンスでバイナリサーチを使用して（以下で説明するように）、各要素を挿入する位置を決定します。

このアルゴリズムは、Sに要素を挿入するために使用されるバイナリサーチが、検索されるサブシーケンスの長さが2のべき乗より1少ない場合に、（最悪の場合の分析の観点から）最も効率的であるという事実を利用するように設計されています。これは、これらの長さの場合、検索のすべての結果が互いに同じ比較回数を使用するためです。これらの長さを生成する挿入順序を選択するために、上記の手順4の後（残りの要素を挿入する前）のソート済みシーケンスSを考え、xiをこのソート済みシーケンスのi番目の要素とします。したがって、

S = (x1, x2, x3, …),

ここで、i≥3の各要素xiは、まだ挿入されていないyi < xiという要素とペアになっています。（x1とx2は互いにペアになっているため、y1またはy2という要素はありません。）nが奇数の場合、残りのペアになっていない要素にも、ペアになっている要素のインデックスよりも大きいインデックスiを持つyiとして番号を付ける必要があります。次に、上記の手順の最後のステップを以下のステップに展開できます。

1. 挿入されていない要素yiを連続したインデックスを持つグループに分割します。最初のグループにはy3とy4の2つの要素があり、隣接する2つのグループのサイズの合計は2のべき乗のシーケンスを形成します。したがって、グループのサイズは2、2、6、10、22、42、...となります。
2. 挿入されていない要素をグループごとに（小さいインデックスから大きいインデックスへ）並べますが、各グループ内では大きいインデックスから小さいインデックスへと並べます。したがって、順序はy4, y3, y6, y5, y12, y11, y10, y9, y8, y7, y22, y21…となります。
3. この順序を使用して、要素yiをSに挿入します。各要素yiについて、Sの先頭からxiまで（xiは含まない）バイナリサーチを使用して、yiを挿入する場所を決定します。

C(n)を、マージ挿入ソートがn個の要素をソートする場合の最悪の場合の比較回数とします。この比較回数は、3つの項の合計として分類できます。

* アイテムのペア間の⌊n/2⌋回の比較、
* 再帰呼び出しのC(⌊n/2⌋)回の比較、および
* 残りの要素を挿入するために使用されるバイナリ挿入の比較回数。

3番目の項では、最初のグループの要素の最悪の場合の比較回数は2です。これは、それぞれが最大3の長さのSのサブシーケンスに挿入されるためです。まず、y4は3要素のサブシーケンス(x1, x2, x3)に挿入されます。次に、y3は3要素のサブシーケンス(x1, x2, y4)の何らかの順列に挿入されるか、場合によっては2要素のサブシーケンス(x1, x2)に挿入されます。同様に、2番目のグループの要素y6とy5は、それぞれ3回の比較を使用して、最大7の長さのサブシーケンスに挿入されます。より一般的には、i番目のグループの要素の最悪の場合の比較回数はi + 1です。これは、それぞれが最大2i+1-1の長さのサブシーケンスに挿入されるためです。すべての要素に使用される比較回数を合計し、結果の漸化式を解くことにより、この分析を使用してC(n)の値を計算し、次の式を得ることができます。

C(n) = Σi=1n⌈log2(3i/4)⌉ ≈ n log2 n − 1.415n

または、閉じた形で、

C(n) = n⌈log2(3n/4)⌉ − ⌊2⌊log2 6n⌋/3⌋ + ⌊log2 6n / 2⌋.

n = 1, 2, …の場合、比較回数は

0, 1, 3, 5, 7, 10, 13, 16, 19, 22, 26, 30, 34, ... (OEISのシーケンスA001768)

このアルゴリズムは、再帰呼び出しの前に実行する初期比較（任意のアイテムをペアリングし、各ペアを比較する）がマージソートの初期比較と同じであり、再帰呼び出しの後に実行する比較（バイナリサーチを使用して要素を1つずつソート済みリストに挿入する）が挿入ソートと同じ原則に従っているため、マージ挿入ソートと呼ばれます。この意味で、マージソートと挿入ソートの両方を組み合わせたハイブリッドアルゴリズムです。

小さな入力（n≤11まで）の場合、その比較回数は、⌈log2 n!⌉≈ n log2 n - 1.443nの比較ソートの下限と等しくなります。ただし、入力サイズが大きい場合、マージ挿入アルゴリズムによる比較回数は、この下限よりも大きくなります。また、マージ挿入ソートは、バイナリ挿入ソートまたはマージソートが最悪の場合に行う比較回数をカウントするソート数よりも少ない比較を実行します。ソート数は、n log2 n - 0.915nとn log2 n - nの間で変動し、主要項は同じですが、低次の線形項の定数係数が悪くなります。

マージ挿入ソートは、n≤22の場合は常にn個のアイテムに対して最小限の比較回数を持つソートアルゴリズムであり、n≤46の場合は既知の最小の比較回数を持っています。20年間、マージ挿入ソートはすべての入力長に対して既知の最小の比較回数を持つソートアルゴリズムでした。しかし、1979年にグレン・マナチャーは、十分に大きい入力に対してさらに少ない比較を使用する別のソートアルゴリズムを発表しました。すべてのnに対してソートに必要な比較回数は正確には不明ですが、マナチャーのアルゴリズムとそれ以降の記録破りのソートアルゴリズムはすべて、マージ挿入ソートの変更を使用しています。
